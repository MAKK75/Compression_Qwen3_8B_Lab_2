
# Lab 2: LLM Compression (Stage 1) - Qwen3-8B AWQ

–í –¥–∞–Ω–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ —Ä–µ—à–µ–Ω–∏–µ **–≠—Ç–∞–ø–∞ 1** –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø–æ –∫–æ–º–ø—Ä–µ—Å—Å–∏–∏ LLM.
–¶–µ–ª—å: –°–∂–∞—Ç—å –º–æ–¥–µ–ª—å **Qwen3-8B** —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–æ—Ç–µ—Ä–µ–π –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –±–µ–Ω—á–º–∞—Ä–∫–µ **MMLU**.

–ú–µ—Ç–æ–¥ —Å–∂–∞—Ç–∏—è: **AWQ (Activation-aware Weight Quantization)** 4-bit.

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
| :--- | :--- | :--- |
| **Original Size** | 15.26 GB | FP16 |
| **Compressed Size** | 5.68 GB | INT4 (AWQ) |
| **Compression Ratio** | **2.69x** | |
| **Baseline Accuracy (MMLU)** | 0.7292 (72.92%) | |
| **Compressed Accuracy (MMLU)** | 0.7167 (71.67%) | |
| **Performance Drop** | 1.72% | |
| **Final Score** | **2.64** | `Ratio / (1 + Drop)` |

–î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –∫–∞–∂–¥–æ–π —Ç–µ–º–µ –±–µ–Ω—á–º–∞—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ —Ñ–∞–π–ª–µ: [mmlu_comparison_detailed.csv](./mmlu_comparison_detailed.csv)

## –°—Å—ã–ª–∫–∏ –Ω–∞ –º–æ–¥–µ–ª–∏

1.  **–ò—Å—Ö–æ–¥–Ω–∞—è –º–æ–¥–µ–ª—å:** [Qwen/Qwen3-8B](https://huggingface.co/Qwen/Qwen3-8B)
2.  **–°–∂–∞—Ç–∞—è –º–æ–¥–µ–ª—å (–º–æ—è):** [NOVORDSEC/qwen3-8b-awq-int4](https://huggingface.co/NOVORDSEC/qwen3-8b-awq-int4)

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–ø—É—Å–∫

–ü—Ä–æ–µ–∫—Ç –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏: —á–µ—Ä–µ–∑ –≥–æ—Ç–æ–≤—ã–µ Python-—Å–∫—Ä–∏–ø—Ç—ã –∏–ª–∏ —á–µ—Ä–µ–∑ Jupyter Notebook.

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
*   **GPU:** –¢—Ä–µ–±—É–µ—Ç—Å—è –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞ NVIDIA (–∫–æ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ T4 16GB).
*   **Python:** 3.12

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

---

### –°–ø–æ—Å–æ–± 1: Python —Å–∫—Ä–∏–ø—Ç—ã

–≠—Ç–æ—Ç —Å–ø–æ—Å–æ–± –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –ª–æ–≥–∏–∫—É —à–∞–≥ –∑–∞ —à–∞–≥–æ–º.

#### –®–∞–≥ 1. –°–∂–∞—Ç–∏–µ –º–æ–¥–µ–ª–∏
–°–∫—Ä–∏–ø—Ç —Å–∫–∞—á–∏–≤–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å, –∫–∞–ª–∏–±—Ä—É–µ—Ç –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–∂–∞—Ç—É—é –≤–µ—Ä—Å–∏—é –≤ –ø–∞–ø–∫—É `./qwen3-8b-awq`.

```bash
python compress.py
```
*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤–µ—Å–∞ —Å HuggingFace, —ç—Ç–æ—Ç —à–∞–≥ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å.*

#### –®–∞–≥ 2. –ó–∞–º–µ—Ä –º–µ—Ç—Ä–∏–∫ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
–°–∫—Ä–∏–ø—Ç —Å–∫–∞—á–∏–≤–∞–µ—Ç (–∏–ª–∏ –±–µ—Ä–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ) —Å–∂–∞—Ç—É—é –º–æ–¥–µ–ª—å, –∑–∞–ø—É—Å–∫–∞–µ—Ç MMLU –±–µ–Ω—á–º–∞—Ä–∫ (20% –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è, –∫–∞–∫ –≤ —É—Å–ª–æ–≤–∏–∏) –∏ —Å—á–∏—Ç–∞–µ—Ç Score.

```bash
python benchmark.py
```
*–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `benchmark.py` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –≥–æ—Ç–æ–≤—ã—Ö –≤–µ—Å–æ–≤ –∏–∑ `NOVORDSEC/qwen3-8b-awq-int4`. –ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –ø–∞–ø–∫—É, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `COMP_MODEL_ID` –≤ —Å–∫—Ä–∏–ø—Ç–µ.*

---

### –°–ø–æ—Å–æ–± 2: Jupyter Notebook

–í–µ—Å—å –ø–∞–π–ø–ª–∞–π–Ω (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫, —Å–∂–∞—Ç–∏–µ, –≤—ã–≥—Ä—É–∑–∫–∞, —Ç–µ—Å—Ç—ã) —Å–æ–±—Ä–∞–Ω –≤ –æ–¥–Ω–æ–º –Ω–æ—É—Ç–±—É–∫–µ. –≠—Ç–æ —Ç–æ—Ç –∂–µ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–ª—Å—è –Ω–∞ Kaggle.

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `Stage1_Compression_And_Benchmark.ipynb`.
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —è—á–µ–π–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ.

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

*   **–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ:** –ö–æ–¥ –∑–∞–ø—É—Å–∫–∞–ª—Å—è –Ω–∞ Kaggle (2x Tesla T4).
*   **–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `AutoAWQ` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ GEMM, w_bit=4, group_size=128.
*   **–ë–µ–Ω—á–º–∞—Ä–∫:** MMLU (Massive Multitask Language Understanding) —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `datasets`. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –≤—ã–±–æ—Ä–∫–∞ `fraction=0.2` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

